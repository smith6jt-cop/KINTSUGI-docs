Traceback (most recent call last):
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\nbclient\client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\jupyter_core\utils\__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\nbclient\client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\nbclient\client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\smith6jt\miniforge3\envs\KINTSUGI\lib\site-packages\nbclient\client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
ome_tiff_path = reg_dir + "merged.ome.tif"
ome_tiff = tifffile.imread(ome_tiff_path)

with tifffile.TiffFile(ome_tiff_path) as tif:

    xml_description = tif.ome_metadata

root = ET.fromstring(xml_description)
namespace = {'ome': 'http://www.openmicroscopy.org/Schemas/OME/2016-06'}

channel_metadata = {}
channel_names = []
for channel in root.findall('.//ome:Channel', namespace):
    channel_name = channel.attrib['Name']
    metadata = {}
    for key, value in channel.attrib.items():
        if key != 'Name':
            metadata[key] = value
    channel_metadata[channel_name] = metadata
    channel_names.append(channel_name)


for channel_name, metadata in channel_metadata.items():

    channel_index = channel_names.index(channel_name)
    channel_data = ome_tiff[channel_index, ...]
    channel_image_path = os.path.join(sig_dir, f'{channel_name}.tif')
    imsave(channel_image_path, channel_data, plugin='tifffile', metadata=metadata)
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mFileNotFoundError[0m                         Traceback (most recent call last)
[1;32m~\AppData\Local\Temp\ipykernel_19340\4071042450.py[0m in [0;36m?[1;34m()[0m
[1;32m----> 2[1;33m [0mome_tiff_path[0m [1;33m=[0m [0mreg_dir[0m [1;33m+[0m [1;34m"merged.ome.tif"[0m[1;33m[0m[1;33m[0m[0m
[0m[0;32m      3[0m [0mome_tiff[0m [1;33m=[0m [0mtifffile[0m[1;33m.[0m[0mimread[0m[1;33m([0m[0mome_tiff_path[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0;32m      4[0m [1;33m[0m[0m
[0;32m      5[0m [1;32mwith[0m [0mtifffile[0m[1;33m.[0m[0mTiffFile[0m[1;33m([0m[0mome_tiff_path[0m[1;33m)[0m [1;32mas[0m [0mtif[0m[1;33m:[0m[1;33m[0m[1;33m[0m[0m

[1;32m~\miniforge3\envs\KINTSUGI\lib\site-packages\tifffile\tifffile.py[0m in [0;36m?[1;34m(files, selection, aszarr, key, series, level, squeeze, maxworkers, buffersize, mode, name, offset, size, pattern, axesorder, categories, imread, sort, container, chunkshape, dtype, axestiled, ioworkers, chunkmode, fillvalue, zattrs, multiscales, omexml, out, out_inplace, _multifile, _useframes, **kwargs)[0m
[0;32m   1074[0m [1;33m[0m[0m
[0;32m   1075[0m         if isinstance(files, str) or not isinstance(
[0;32m   1076[0m             [0mfiles[0m[1;33m,[0m [0mcollections[0m[1;33m.[0m[0mabc[0m[1;33m.[0m[0mSequence[0m[1;33m[0m[1;33m[0m[0m
[0;32m   1077[0m         ):
[1;32m-> 1078[1;33m             with TiffFile(
[0m[0;32m   1079[0m                 [0mfiles[0m[1;33m,[0m[1;33m[0m[1;33m[0m[0m
[0;32m   1080[0m                 [0mmode[0m[1;33m=[0m[0mmode[0m[1;33m,[0m[1;33m[0m[1;33m[0m[0m
[0;32m   1081[0m                 [0mname[0m[1;33m=[0m[0mname[0m[1;33m,[0m[1;33m[0m[1;33m[0m[0m

[1;32m~\miniforge3\envs\KINTSUGI\lib\site-packages\tifffile\tifffile.py[0m in [0;36m?[1;34m(self, file, mode, name, offset, size, omexml, _multifile, _useframes, _parent, **is_flags)[0m
[0;32m   4072[0m                 [1;32mraise[0m [0mValueError[0m[1;33m([0m[1;34m'invalid OME-XML'[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0;32m   4073[0m             [0mself[0m[1;33m.[0m[0m_omexml[0m [1;33m=[0m [0momexml[0m[1;33m[0m[1;33m[0m[0m
[0;32m   4074[0m             [0mself[0m[1;33m.[0m[0mis_ome[0m [1;33m=[0m [1;32mTrue[0m[1;33m[0m[1;33m[0m[0m
[0;32m   4075[0m [1;33m[0m[0m
[1;32m-> 4076[1;33m         [0mfh[0m [1;33m=[0m [0mFileHandle[0m[1;33m([0m[0mfile[0m[1;33m,[0m [0mmode[0m[1;33m=[0m[0mmode[0m[1;33m,[0m [0mname[0m[1;33m=[0m[0mname[0m[1;33m,[0m [0moffset[0m[1;33m=[0m[0moffset[0m[1;33m,[0m [0msize[0m[1;33m=[0m[0msize[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0m[0;32m   4077[0m         [0mself[0m[1;33m.[0m[0m_fh[0m [1;33m=[0m [0mfh[0m[1;33m[0m[1;33m[0m[0m
[0;32m   4078[0m         [0mself[0m[1;33m.[0m[0m_multifile[0m [1;33m=[0m [1;32mTrue[0m [1;32mif[0m [0m_multifile[0m [1;32mis[0m [1;32mNone[0m [1;32melse[0m [0mbool[0m[1;33m([0m[0m_multifile[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0;32m   4079[0m         [0mself[0m[1;33m.[0m[0m_files[0m [1;33m=[0m [1;33m{[0m[0mfh[0m[1;33m.[0m[0mname[0m[1;33m:[0m [0mself[0m[1;33m}[0m[1;33m[0m[1;33m[0m[0m

[1;32m~\miniforge3\envs\KINTSUGI\lib\site-packages\tifffile\tifffile.py[0m in [0;36m?[1;34m(self, file, mode, name, offset, size)[0m
[0;32m  14258[0m         [0mself[0m[1;33m.[0m[0m_offset[0m [1;33m=[0m [1;33m-[0m[1;36m1[0m [1;32mif[0m [0moffset[0m [1;32mis[0m [1;32mNone[0m [1;32melse[0m [0moffset[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14259[0m         [0mself[0m[1;33m.[0m[0m_size[0m [1;33m=[0m [1;33m-[0m[1;36m1[0m [1;32mif[0m [0msize[0m [1;32mis[0m [1;32mNone[0m [1;32melse[0m [0msize[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14260[0m         [0mself[0m[1;33m.[0m[0m_close[0m [1;33m=[0m [1;32mTrue[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14261[0m         [0mself[0m[1;33m.[0m[0m_lock[0m [1;33m=[0m [0mNullContext[0m[1;33m([0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[1;32m> 14262[1;33m         [0mself[0m[1;33m.[0m[0mopen[0m[1;33m([0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0m[0;32m  14263[0m         [1;32massert[0m [0mself[0m[1;33m.[0m[0m_fh[0m [1;32mis[0m [1;32mnot[0m [1;32mNone[0m[1;33m[0m[1;33m[0m[0m

[1;32m~\miniforge3\envs\KINTSUGI\lib\site-packages\tifffile\tifffile.py[0m in [0;36m?[1;34m(self)[0m
[0;32m  14277[0m             [1;32mif[0m [0mself[0m[1;33m.[0m[0m_mode[0m [1;32mnot[0m [1;32min[0m [1;33m{[0m[1;34m'rb'[0m[1;33m,[0m [1;34m'r+b'[0m[1;33m,[0m [1;34m'wb'[0m[1;33m,[0m [1;34m'xb'[0m[1;33m}[0m[1;33m:[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14278[0m                 [1;32mraise[0m [0mValueError[0m[1;33m([0m[1;34mf'invalid mode {self._mode}'[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14279[0m             [0mself[0m[1;33m.[0m[0m_file[0m [1;33m=[0m [0mos[0m[1;33m.[0m[0mpath[0m[1;33m.[0m[0mrealpath[0m[1;33m([0m[0mself[0m[1;33m.[0m[0m_file[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14280[0m             [0mself[0m[1;33m.[0m[0m_dir[0m[1;33m,[0m [0mself[0m[1;33m.[0m[0m_name[0m [1;33m=[0m [0mos[0m[1;33m.[0m[0mpath[0m[1;33m.[0m[0msplit[0m[1;33m([0m[0mself[0m[1;33m.[0m[0m_file[0m[1;33m)[0m[1;33m[0m[1;33m[0m[0m
[1;32m> 14281[1;33m             self._fh = open(
[0m[0;32m  14282[0m                 [0mself[0m[1;33m.[0m[0m_file[0m[1;33m,[0m [0mself[0m[1;33m.[0m[0m_mode[0m[1;33m,[0m [0mencoding[0m[1;33m=[0m[1;32mNone[0m[1;33m[0m[1;33m[0m[0m
[0;32m  14283[0m             )  # type: ignore
[0;32m  14284[0m             [0mself[0m[1;33m.[0m[0m_close[0m [1;33m=[0m [1;32mTrue[0m[1;33m[0m[1;33m[0m[0m

[1;31mFileNotFoundError[0m: [Errno 2] No such file or directory: 'C:\\Users\\smith6jt\\KINTSUGI\\data\\1904_CC2B_Registrationmerged.ome.tif'

